工作空间模型动态基础模型切换完整技术方案
需求分析
基于您的描述，需要实现在聊天界面中为工作空间模型提供动态切换基础模型的功能，同时保持工作空间模型的自定义参数（系统提示词、温度等设置）不变。

技术方案设计
1. 前端UI组件设计
1.1 增强ModelSelector组件
需要在现有的ModelSelector组件基础上，为工作空间模型添加基础模型切换功能。 ModelSelector.svelte:1-46

在聊天界面的模型选择器中，当选中工作空间模型时，显示一个额外的基础模型选择下拉框。

1.2 新增BaseModelSwitcher组件
创建专门的基础模型切换器组件，类似于现有的Selector组件设计。 Selector.svelte:94-136

该组件需要：

列出所有可用的外部连接模型和本地模型
支持搜索和筛选功能
实时预览基础模型信息
2. 状态管理增强
2.1 扩展模型状态结构
在现有的selectedModels状态基础上，增加动态基础模型映射：

selectedModels: string[]  
dynamicBaseModels: { [workspaceModelId: string]: string }
2.2 工作空间模型识别
利用现有的模型结构中的preset字段和base_model_id来识别工作空间模型。 ModelEditor.svelte:62-73

3. 参数继承机制
3.1 保留工作空间模型参数
确保在切换基础模型时，工作空间模型的以下参数保持不变：

系统提示词 (system prompt)
高级参数 (temperature, top_p, etc.)
功能配置 (capabilities)
工具和知识库配置 ModelEditor.svelte:75-86
3.2 能力特性继承
需要处理基础模型特定的能力，如OpenAI模型的usage统计功能。 ModelEditor.svelte:95-106

4. 后端API扩展
4.1 临时基础模型覆盖API
需要在后端添加支持临时覆盖工作空间模型基础模型的功能，而不影响原始配置。

4.2 模型解析增强
在聊天请求处理时，需要动态解析实际使用的基础模型，同时应用工作空间模型的参数配置。

5. 用户界面交互流程
5.1 模型选择流程
用户在聊天界面选择工作空间模型
系统检测到是工作空间模型，显示基础模型切换器
用户可以从所有可用模型中选择新的基础模型
系统实时更新并保持工作空间参数
5.2 切换效果展示
在模型名称显示中，需要清晰展示当前使用的工作空间模型名称和实际基础模型，例如：

"我的助手 (基于 gpt-4o)"  
6. 实现细节
6.1 模型过滤逻辑
参考现有的模型过滤机制，排除隐藏模型和不可用模型。 Selector.svelte:118-136

6.2 搜索和标签支持
为基础模型切换器提供与主模型选择器相同的搜索和标签筛选功能。 Selector.svelte:78-92

7. 数据持久化
7.1 会话级别存储
动态基础模型选择应该在当前聊天会话中持久化，但不影响工作空间模型的原始配置。

7.2 用户偏好记忆
可以考虑为用户记住特定工作空间模型的基础模型偏好设置。

8. 错误处理和回退
8.1 基础模型不可用处理
当选中的基础模型不可用时，自动回退到工作空间模型的原始base_model_id。

8.2 参数兼容性检查
确保工作空间模型的参数与新选择的基础模型兼容。

Notes
这个方案的核心是在不修改工作空间模型原始配置的前提下，提供运行时的基础模型切换能力。实现时需要特别注意参数继承的正确性和用户体验的流畅性。建议分阶段实施，先实现基础的UI组件和状态管理，再逐步完善高级功能。

该方案充分利用了Open WebUI现有的模型管理架构，特别是工作空间模型的参数系统和聊天界面的模型选择机制，确保新功能与现有系统的良好集成。